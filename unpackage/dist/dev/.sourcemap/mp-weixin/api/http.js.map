{"version":3,"file":"http.js","sources":["api/http.js"],"sourcesContent":["// http://apifox.com/apidoc/shared-8776d148-3d28-42a1-bf4b-c2285ac6e644/api-264486153\r\nlet baseUrl = '';\r\n\r\n//mock模拟数据\r\n// baseUrl = 'https://m1.apifoxmock.com/m1/4728220-0-default/api'\r\n// 本地数据，通过Vite代理转发\r\nbaseUrl = 'http://localhost:8081'\r\n\r\nexport default function http(url, data = {}, method = 'GET') {\r\n\treturn new Promise((resolve, reject) => {\r\n\t\tuni.request({\r\n\t\t\turl: baseUrl + (url.startsWith('/') ? url : '/' + url), // 确保路径拼接正确\r\n\t\t\tdata,\r\n\t\t\tmethod,\r\n\t\t\theader: {\r\n\t\t\t\t'token': uni.getStorageSync('token') || '', // 使用同步方法获取 token\r\n\t\t\t},\r\n\t\t\tsuccess: res => {\r\n\t\t\t\tif (res.statusCode === 200) {\r\n\t\t\t\tif (res.data.code === 1 || res.data.code === 200) {\r\n\t\t\t\t\tresolve(res.data.data);\r\n\t\t\t\t} else if (res.data.code === 0) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: res.data.msg,\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t});\r\n\t\t\t\t\treject(res.data.msg);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t},\r\n\t\t\tfail: () => {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '服务器请求失败，请稍后重试', // 修改为更明确的提示信息\r\n\t\t\t\t\ticon: 'none',\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t});\r\n\t});\r\n}"],"names":["uni"],"mappings":";;AACA,IAAI,UAAU;AAKd,UAAU;AAEK,SAAS,KAAK,KAAK,OAAO,CAAA,GAAI,SAAS,OAAO;AAC5D,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACvCA,kBAAAA,MAAI,QAAQ;AAAA,MACX,KAAK,WAAW,IAAI,WAAW,GAAG,IAAI,MAAM,MAAM;AAAA;AAAA,MAClD;AAAA,MACA;AAAA,MACA,QAAQ;AAAA,QACP,SAASA,cAAG,MAAC,eAAe,OAAO,KAAK;AAAA;AAAA,MACxC;AAAA,MACD,SAAS,SAAO;AACf,YAAI,IAAI,eAAe,KAAK;AAC5B,cAAI,IAAI,KAAK,SAAS,KAAK,IAAI,KAAK,SAAS,KAAK;AACjD,oBAAQ,IAAI,KAAK,IAAI;AAAA,UACrB,WAAU,IAAI,KAAK,SAAS,GAAG;AAC/BA,0BAAAA,MAAI,UAAU;AAAA,cACb,OAAO,IAAI,KAAK;AAAA,cAChB,MAAM;AAAA,YACZ,CAAM;AACD,mBAAO,IAAI,KAAK,GAAG;AAAA,UACnB;AAAA,QACD;AAAA,MACA;AAAA,MACD,MAAM,MAAM;AACXA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA;AAAA,UACP,MAAM;AAAA,QACX,CAAK;AAAA,MACD;AAAA,IACJ,CAAG;AAAA,EACH,CAAE;AACF;;"}